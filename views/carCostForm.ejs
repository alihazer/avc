<section>
    <div class="container">
        <div>
            <a href="/cars/costs/all" class="back-arrow1"><i class="fa-solid fa-arrow-left"></i></a>
            <div class="card">
                <div class="card-header">
                    <h4>Edit Car Cost Form</h4>
                </div>
                <div class="card-body">
                    <form action="/cars/costs/edit/<%= carCost._id %>" method="POST">
                        <div class="form-group" id="carId">
                            <label for="carId">رقم السيارة </label>
                            <select name="carId" id="car">
                                <% cars.forEach(car => { %>
                                    <option value="<%= car._id %>" <%= car._id.toString() === carCost.carId.toString() ? 'selected' : '' %> >
                                        <%= car.number %>
                                    </option>
                                <% }); %>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="cause">السبب</label>
                            <select name="cause" id="carCostCause">
                                <option value="select">اختر</option>
                                <option value="maintenance" <%= carCost.cause === "maintenance" ? 'selected' : '' %>>صيانة</option>
                                <option value="benzine" <%= carCost.cause === "benzine" ? 'selected' : '' %>>بنزين</option>
                                <option value="oilchange" <%= carCost.cause === "oilchange" ? 'selected' : '' %>>غيار زيت</option>
                            </select>
                        </div>

                        <div class="form-group" id="speedoMeterValue">
                            <label>العداد</label>
                            <input type="number" name="speedoMeterValue" value="<%= carCost.speedoMeterValue %>">
                        </div>

                        <div class="form-group" id="litersCount">
                            <label>الكمية / ليتر</label>
                            <input type="number" name="litersCount" value="<%= carCost.litersCount %>">
                        </div>

                        <div class="form-group">
                            <label for="person">اسم الشخص المسؤول</label>
                            <select name="person" id="person" class="person-select" multiple>
                                <% users.forEach(function(person){ %>
                                    <option value="<%= person.id %>" <%= carCost.person.includes(person.id) ? 'selected' : '' %> >
                                        <%= person.username %>
                                    </option>
                                <% }) %>
                            </select>
                        </div>                        

                        <div class="form-group">
                            <label for="cost">التكلفة</label>
                            <input type="number" name="cost" id="cost" required value="<%= carCost.cost %>">
                        </div>

                        <div class="form-group">
                            <label for="currency">العملة</label>
                            <select name="currency" id="currency">
                                <option value="usd" <%= carCost.currency === "usd" ? 'selected' : '' %>>دولار</option>
                                <option value="lbp" <%= carCost.currency === "lbp" ? 'selected' : '' %>>ليرة لبنانية</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="date">التاريخ</label>
                            <input type="date" name="date" id="date" required value="<%= carCost.date.toISOString().split('T')[0] %>">
                        </div>

                        <div class="form-group">
                            <label for="notes">ملاحظات</label>
                            <textarea name="notes" id="notes" cols="30" rows="10"><%= carCost.notes %></textarea>
                        </div>

                        <div class="form-group">
                            <label for="company">المؤسسة</label>
                            <input type="text" name="paidFor" id="companyInput" value="<%= carCost.paidFor %>">
                            
                            <select id="companyInputOil" name="paidFor" class="company-select" style="display: none;">
                                <option value="عباس عاصي" <%= carCost.paidFor === "عباس عاصي" ? 'selected' : '' %>>عباس عاصي</option>
                                <option value="other">other</option>
                            </select>

                            <select id="companyInputBenzine" class="company-select" name="paidFor" style="display: none;">
                                <option value="محطة حازر" <%= carCost.paidFor === "محطة حازر" ? 'selected' : '' %>>محطة حازر</option>
                                <option value="محطة فايز قبيسي" <%= carCost.paidFor === "محطة فايز قبيسي" ? 'selected' : '' %>>محطة فايز قبيسي</option>
                                <option value="محطة الشيخ علي" <%= carCost.paidFor === "محطة الشيخ علي" ? 'selected' : '' %>>محطة الشيخ علي</option>
                                <option value="محطة رشاد عاصي" <%= carCost.paidFor === "محطة رشاد عاصي" ? 'selected' : '' %>>محطة رشاد عاصي</option>
                                <option value="محطة محمد عاصي" <%= carCost.paidFor === "محطة محمد عاصي" ? 'selected' : '' %>>محطة محمد عاصي</option>
                                <option value="محطة فارس" <%= carCost.paidFor === "محطة فارس" ? 'selected' : '' %>>محطة فارس</option>
                                <option value="محطة الهادي" <%= carCost.paidFor === "محطة الهادي" ? 'selected' : '' %>>محطة الهادي</option>
                                <option value="محطة أبو كرم" <%= carCost.paidFor === "محطة أبو كرم" ? 'selected' : '' %>>محطة أبو كرم</option>
                                <option value="محطة خالد فياض" <%= carCost.paidFor === "محطة خالد فياض" ? 'selected' : '' %>>محطة خالد فياض</option>
                                <option value="other">other</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Update</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
